
# ğŸ“ŒSubquery

> query ì•ˆì— query ê°€ ìˆëŠ”  query
> 
- ë©”ì¸ queryê°€ query ì¿¼ë¦¬ë¥¼ í¬í•¨í•˜ëŠ” ì¢…ì†ì ì¸ êµ¬ì¡°
- SELECT, FROM, WHERE, HAVING, ORDER BY ì™¸ì— INSERT, UPDATEì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### INSERT

- **INSERT** **INTO** table(col1, col2... ) **SELECT** val1 , val2.... **FROM** table **WHERE**....

```sql
INSERT INTO prices (group_id, id, price)
SELECT 7, articleId, 1.50 FROM article  WHERE name like 'ABC%';
```

### UPDATE

- **UPDATE** table **SET** col1 = val1, col2 = val2, ... **WHERE** ...

```sql
UPDATE person SET street = 'GREEN TEA STREET', state = 'MA', country = 'KR', postal_code = '13122' WHERE person_id = 1;
```

### Single Row Subquery

- ê²°ê³¼ê°€ í•˜ë‚˜ì˜ í–‰ìœ¼ë¡œ ë‚˜ì˜¤ëŠ” subquery
- =, <. >. != ì˜ ì—°ì‚°ì

```sql
SELECT city 
FROM city 
WHERE country_id = (
        SELECT country_id 
        FROM country 
		WHERE country = 'South Korea');
```

### Multiple Row Subquery

- ê²°ê³¼ê°€ 2ê±´ ì´ìƒì˜ rowë¡œ ë‚˜ì˜¤ëŠ” subquery
- IN, >, < ë“±ì˜ ì—°ì‚°ì

```sql
SELECT country_id
FROM country
WHERE country IN ('Canada', 'Mexico');
```

### Multiple Column Subquery

- ê²°ê³¼ê°€ 2ê°œ ì´ìƒì˜ columnì„ ê°–ëŠ” subquery
- IN, >, < ë“±ì˜ ì—°ì‚°ì

```sql
SELECT * 
FROM EMPLOYEE 
WHERE(JOB, SAL) IN (
				SELECT JOB, MAX(SAL) 
				FROM EMPLOYEE 
				GROUP BY JOB);
```

# ğŸ“ŒDDL

## CREATE

- í…Œì´ë¸” ìƒì„± query
- ìƒì„±ê³¼ í•¨ê»˜ columnì˜ ì œì•½ì¡°ê±´ì„ ëª…ì‹œí•  ìˆ˜ ìˆë‹¤.

```sql
CREATE TABLE í…Œì´ë¸”ëª…(
ì»¬ëŸ¼ëª…, datatype, ì œì•½ì¡°ê±´ ì´ë¦„, 
ì»¬ëŸ¼ëª…, datatype, ì œì•½ì¡°ê±´, 
ì»¬ëŸ¼ëª…, datatype, ì œì•½ì¡°ê±´, 
...
CONSTRAINT pkname PRIMARY KEY (ì»¬ëŸ¼ëª…, ...)
);
```

## DROP

- í…Œì´ë¸” ì‚­ì œ query
- í†µì§¸ë¡œ ì‚¬ë¼ì§„ë‹¤.

```sql
DROP TABLE í…Œì´ë¸”ëª…
```

## ALTER

- í…Œì´ë¸”ì˜ ì œì•½ì¡°ê±´ ë³€ê²½ query

```sql
ALTER TABLE ìì‹í…Œì´ë¸”ëª… ADD CONSTRAINT ì œì•½ì¡°ê±´ ì´ë¦„ FOREIGN KEY ìì‹ì»¬ëŸ¼ëª… REFERENCES ë¶€ëª¨í…Œì´ë¸”ëª… (PKì´ë¦„)
```

- ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ ë¹„í™œì„±í™”

```sql
SET FOREIGN_KEY_CHECKS = 0;
```

- ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ í™œì„±í™”

```sql
SET FOREIGN_KEY_CHECKS = 1;
```

### **FOREIGN_KEY_CHECKS ê³ ì°°**

> ì–´ë–¤ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ì¸ì§€ ì§€ì •ë„ ì•ˆí•˜ê³  ëƒ…ë‹¤ `FOREIGN_KEY_CHECKS` í•´ë²„ë ¤ë„ ë˜ëŠ”ì§€?
> 

â†’ **ëœë‹¤!** 

- `FOREIGN_KEY_CHECKS` ëŠ” ë‘ ê°€ì§€ íƒ€ì…ì˜ ì„¤ì •ì´ ìˆëŠ”ë°, ì „ì—­ ì„¤ì •ê³¼ ì§€ì—­ ì„¤ì •ì´ ìˆë‹¤
- ì§€ì—­ ì„¤ì •ì˜ ê²½ìš°ì—ëŠ” ì„¸ì…˜ì´ ì‹¤í–‰í•  ë™ì•ˆ ëª¨ë“  í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ì„ í™œì„±í™”/ë¹„í™œì„±í™”í•œë‹¤. ì‚¬ì‹¤ ì§€ì—­ì´ë‚˜ ì „ì—­ì´ë‚˜ êµ¬ë¶„ì´ ì—†ëŠ” ëŠë‚Œì´ë‹¤.
- ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ì„ ë¹„í™œì„±í™” í–ˆë‹¤ë©´, ë‹¤ì‹œ í™œì„±í™”ë¥¼ í•´ë‘ëŠ” ê²ƒì´ ì¢‹ê² ë‹¤.
---

# ğŸ“ŒJDBC

> Java applicationì—ì„œ Databaseì— ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ìë°” **API**


![](https://velog.velcdn.com/images/pdg0526/post/0c1693d1-3879-4944-bc44-987dff65999e/image.png)


### JDBC ìˆœì„œ

1. Import library
    
    `import java.sql.Statement;
    import java.sql.ResultSet;
    import java.sql.SQLException;
    import utils.DBUtils;`
    
2. DriverManager.getConnection()ì„ í†µí•´ Connection instance ìƒì„±.
    
    `Connection connection = DBUtils.getConnection();`
    
3. Connection instanceë¥¼ í†µí•´ Statement instance ìƒì„±.
    
    `Statement statement = connection.createStatement();`
    
4. Query ë¬¸ì„ Statement instanceì˜ execute ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ ResultSet instanceë¥¼ ì–»ëŠ”ë‹¤. 
    
    `ResultSet resultSet = statement.executeQuery("query");`
    
5. ResultSet instanceì˜ get()ë¥¼ í†µí•´ í•˜ë‚˜ì˜ row ì¤‘ ì›í•˜ëŠ” columnì„ ì–»ëŠ”ë‹¤. 
    
    `String col_value= resultSet.getString("column");`
    
6. ResultSet, Statement, Connection ì¸ìŠ¤í„´ìŠ¤ì˜ ìì›ì„ í•´ì œí•œë‹¤. 
    
    `resultSet.close();`
    
    `statement.close();`
    
    `connection.close();`